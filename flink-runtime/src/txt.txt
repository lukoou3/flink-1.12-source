-- 写入buffer
"Legacy Source Thread - Source: Custom Source -> Map (1/1)#0@7771" prio=5 tid=0x47 nid=NA runnable
  java.lang.Thread.State: RUNNABLE
	  at org.apache.flink.runtime.io.network.partition.PipelinedSubpartition.addBuffer(PipelinedSubpartition.java:180)
	  at org.apache.flink.runtime.io.network.partition.PipelinedSubpartition.add(PipelinedSubpartition.java:155)
	  - locked <0x1f91> (a org.apache.flink.runtime.io.network.partition.PrioritizedDeque)
	  at org.apache.flink.runtime.io.network.partition.PipelinedSubpartition.add(PipelinedSubpartition.java:127)
	  at org.apache.flink.runtime.io.network.partition.BufferWritingResultPartition.appendUnicastDataForRecordContinuation(BufferWritingResultPartition.java:265)
	  at org.apache.flink.runtime.io.network.partition.BufferWritingResultPartition.emitRecord(BufferWritingResultPartition.java:149)
	  at org.apache.flink.runtime.io.network.api.writer.RecordWriter.emit(RecordWriter.java:104)
	  at org.apache.flink.runtime.io.network.api.writer.ChannelSelectorRecordWriter.emit(ChannelSelectorRecordWriter.java:54)
	  at org.apache.flink.streaming.runtime.io.RecordWriterOutput.pushToRecordWriter(RecordWriterOutput.java:101)
	  at org.apache.flink.streaming.runtime.io.RecordWriterOutput.collect(RecordWriterOutput.java:87)
	  at org.apache.flink.streaming.runtime.io.RecordWriterOutput.collect(RecordWriterOutput.java:43)
	  at org.apache.flink.streaming.api.operators.CountingOutput.collect(CountingOutput.java:50)
	  at org.apache.flink.streaming.api.operators.CountingOutput.collect(CountingOutput.java:28)
	  at org.apache.flink.streaming.api.operators.StreamMap.processElement(StreamMap.java:38)
	  at org.apache.flink.streaming.runtime.tasks.ChainingOutput.pushToOperator(ChainingOutput.java:112)
	  at org.apache.flink.streaming.runtime.tasks.ChainingOutput.collect(ChainingOutput.java:93)
	  at org.apache.flink.streaming.runtime.tasks.ChainingOutput.collect(ChainingOutput.java:39)
	  at org.apache.flink.streaming.api.operators.CountingOutput.collect(CountingOutput.java:50)
	  at org.apache.flink.streaming.api.operators.CountingOutput.collect(CountingOutput.java:28)
	  at org.apache.flink.streaming.api.operators.StreamSourceContexts$ManualWatermarkContext.processAndCollect(StreamSourceContexts.java:317)
	  at org.apache.flink.streaming.api.operators.StreamSourceContexts$WatermarkContext.collect(StreamSourceContexts.java:411)
	  - locked <0x1fb2> (a java.lang.Object)
	  at scala.stream.debug.scala.OnlineLogSouce$$anonfun$run$1.apply$mcVI$sp(OnlineLogSouce.scala:47)
	  at scala.collection.immutable.Range.foreach$mVc$sp(Range.scala:160)
	  at scala.stream.debug.scala.OnlineLogSouce.run(OnlineLogSouce.scala:41)
	  at org.apache.flink.streaming.api.operators.StreamSource.run(StreamSource.java:110)
	  at org.apache.flink.streaming.api.operators.StreamSource.run(StreamSource.java:66)
	  at org.apache.flink.streaming.runtime.tasks.SourceStreamTask$LegacySourceFunctionThread.run(SourceStreamTask.java:263)

"Legacy Source Thread - Source: Custom Source -> Map (1/1)#0@7781" prio=5 tid=0x47 nid=NA waiting
  java.lang.Thread.State: WAITING
	  at sun.misc.Unsafe.park(Unsafe.java:-1)
	  at java.util.concurrent.locks.LockSupport.park(LockSupport.java:175)
	  at java.util.concurrent.CompletableFuture$Signaller.block(CompletableFuture.java:1693)
	  at java.util.concurrent.ForkJoinPool.managedBlock(ForkJoinPool.java:3323)
	  at java.util.concurrent.CompletableFuture.waitingGet(CompletableFuture.java:1729)
	  at java.util.concurrent.CompletableFuture.get(CompletableFuture.java:1895)
	  at org.apache.flink.runtime.io.network.buffer.LocalBufferPool.requestMemorySegmentBlocking(LocalBufferPool.java:319)
	  at org.apache.flink.runtime.io.network.buffer.LocalBufferPool.requestBufferBuilderBlocking(LocalBufferPool.java:291)
	  at org.apache.flink.runtime.io.network.partition.BufferWritingResultPartition.requestNewBufferBuilderFromPool(BufferWritingResultPartition.java:337)
	  at org.apache.flink.runtime.io.network.partition.BufferWritingResultPartition.requestNewUnicastBufferBuilder(BufferWritingResultPartition.java:313)
	  at org.apache.flink.runtime.io.network.partition.BufferWritingResultPartition.appendUnicastDataForRecordContinuation(BufferWritingResultPartition.java:257)
	  at org.apache.flink.runtime.io.network.partition.BufferWritingResultPartition.emitRecord(BufferWritingResultPartition.java:149)
	  at org.apache.flink.runtime.io.network.api.writer.RecordWriter.emit(RecordWriter.java:104)
	  at org.apache.flink.runtime.io.network.api.writer.ChannelSelectorRecordWriter.emit(ChannelSelectorRecordWriter.java:54)
	  at org.apache.flink.streaming.runtime.io.RecordWriterOutput.pushToRecordWriter(RecordWriterOutput.java:101)
	  at org.apache.flink.streaming.runtime.io.RecordWriterOutput.collect(RecordWriterOutput.java:87)
	  at org.apache.flink.streaming.runtime.io.RecordWriterOutput.collect(RecordWriterOutput.java:43)
	  at org.apache.flink.streaming.api.operators.CountingOutput.collect(CountingOutput.java:50)
	  at org.apache.flink.streaming.api.operators.CountingOutput.collect(CountingOutput.java:28)
	  at org.apache.flink.streaming.api.operators.StreamMap.processElement(StreamMap.java:38)
	  at org.apache.flink.streaming.runtime.tasks.ChainingOutput.pushToOperator(ChainingOutput.java:112)
	  at org.apache.flink.streaming.runtime.tasks.ChainingOutput.collect(ChainingOutput.java:93)
	  at org.apache.flink.streaming.runtime.tasks.ChainingOutput.collect(ChainingOutput.java:39)
	  at org.apache.flink.streaming.api.operators.CountingOutput.collect(CountingOutput.java:50)
	  at org.apache.flink.streaming.api.operators.CountingOutput.collect(CountingOutput.java:28)
	  at org.apache.flink.streaming.api.operators.StreamSourceContexts$ManualWatermarkContext.processAndCollect(StreamSourceContexts.java:317)
	  at org.apache.flink.streaming.api.operators.StreamSourceContexts$WatermarkContext.collect(StreamSourceContexts.java:411)
	  - locked <0x1f77> (a java.lang.Object)
	  at scala.stream.debug.scala.OnlineLogSouce$$anonfun$run$1.apply$mcVI$sp(OnlineLogSouce.scala:47)
	  at scala.collection.immutable.Range.foreach$mVc$sp(Range.scala:160)
	  at scala.stream.debug.scala.OnlineLogSouce.run(OnlineLogSouce.scala:41)
	  at org.apache.flink.streaming.api.operators.StreamSource.run(StreamSource.java:110)
	  at org.apache.flink.streaming.api.operators.StreamSource.run(StreamSource.java:66)
	  at org.apache.flink.streaming.runtime.tasks.SourceStreamTask$LegacySourceFunctionThread.run(SourceStreamTask.java:263)

-- 下游 读
"Filter -> Sink: Unnamed (1/1)#0@6148" prio=5 tid=0x44 nid=NA runnable
  java.lang.Thread.State: RUNNABLE
	  at org.apache.flink.runtime.io.network.partition.consumer.RemoteInputChannel.getNextBuffer(RemoteInputChannel.java:211)
	  - locked <0x1fe7> (a org.apache.flink.runtime.io.network.partition.PrioritizedDeque)
	  at org.apache.flink.runtime.io.network.partition.consumer.SingleInputGate.waitAndGetNextData(SingleInputGate.java:650)
	  - locked <0x1edc> (a org.apache.flink.runtime.io.network.partition.PrioritizedDeque)
	  at org.apache.flink.runtime.io.network.partition.consumer.SingleInputGate.getNextBufferOrEvent(SingleInputGate.java:625)
	  at org.apache.flink.runtime.io.network.partition.consumer.SingleInputGate.pollNext(SingleInputGate.java:611)
	  at org.apache.flink.runtime.taskmanager.InputGateWithMetrics.pollNext(InputGateWithMetrics.java:109)
	  at org.apache.flink.streaming.runtime.io.CheckpointedInputGate.pollNext(CheckpointedInputGate.java:148)
	  at org.apache.flink.streaming.runtime.io.StreamTaskNetworkInput.emitNext(StreamTaskNetworkInput.java:179)
	  at org.apache.flink.streaming.runtime.io.StreamOneInputProcessor.processInput(StreamOneInputProcessor.java:65)
	  at org.apache.flink.streaming.runtime.tasks.StreamTask.processInput(StreamTask.java:396)
	  at org.apache.flink.streaming.runtime.tasks.StreamTask$$Lambda$150.794043054.runDefaultAction(Unknown Source:-1)
	  at org.apache.flink.streaming.runtime.tasks.mailbox.MailboxProcessor.runMailboxLoop(MailboxProcessor.java:191)
	  at org.apache.flink.streaming.runtime.tasks.StreamTask.runMailboxLoop(StreamTask.java:617)
	  at org.apache.flink.streaming.runtime.tasks.StreamTask.invoke(StreamTask.java:581)
	  at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:755)
	  at org.apache.flink.runtime.taskmanager.Task.run(Task.java:570)
	  at java.lang.Thread.run(Thread.java:748)

-- AddCredit server
"Flink Netty Server (0) Thread 0@5334" daemon prio=5 tid=0x37 nid=NA runnable
  java.lang.Thread.State: RUNNABLE
	  at org.apache.flink.runtime.io.network.netty.PartitionRequestQueue.writeAndFlushNextMessageIfPossible(PartitionRequestQueue.java:216)
	  at org.apache.flink.runtime.io.network.netty.PartitionRequestQueue.enqueueAvailableReader(PartitionRequestQueue.java:110)
	  at org.apache.flink.runtime.io.network.netty.PartitionRequestQueue.addCreditOrResumeConsumption(PartitionRequestQueue.java:160)
	  at org.apache.flink.runtime.io.network.netty.PartitionRequestServerHandler.channelRead0(PartitionRequestServerHandler.java:119)
	  at org.apache.flink.runtime.io.network.netty.PartitionRequestServerHandler.channelRead0(PartitionRequestServerHandler.java:41)
	  at org.apache.flink.shaded.netty4.io.netty.channel.SimpleChannelInboundHandler.channelRead(SimpleChannelInboundHandler.java:99)
	  at org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379)
	  at org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365)
	  at org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357)
	  at org.apache.flink.shaded.netty4.io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:324)
	  at org.apache.flink.shaded.netty4.io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:296)
	  at org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379)
	  at org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365)
	  at org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357)
	  at org.apache.flink.shaded.netty4.io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1410)
	  at org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379)
	  at org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365)
	  at org.apache.flink.shaded.netty4.io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:919)
	  at org.apache.flink.shaded.netty4.io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:163)
	  at org.apache.flink.shaded.netty4.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:714)
	  at org.apache.flink.shaded.netty4.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:650)
	  at org.apache.flink.shaded.netty4.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:576)
	  at org.apache.flink.shaded.netty4.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:493)
	  at org.apache.flink.shaded.netty4.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989)
	  at org.apache.flink.shaded.netty4.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	  at java.lang.Thread.run(Thread.java:748)


/127.0.0.1:63237
